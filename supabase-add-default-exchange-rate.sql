-- ============================================
-- Миграция: Добавление поля default_exchange_rate в profiles
-- Описание: Добавляет поле для хранения курса обмена по умолчанию (RUB/USD)
-- Дата: 2026-01-02
-- ============================================

-- Добавляем поле default_exchange_rate в таблицу profiles
-- Это курс обмена RUB/USD (сколько рублей за доллар)
-- Используется для конвертации сумм при создании транзакций для проектов
-- в валюте, отличной от валюты счета
ALTER TABLE public.profiles
ADD COLUMN IF NOT EXISTS default_exchange_rate numeric DEFAULT 100 CHECK (default_exchange_rate > 0);

-- Комментарий к полю
COMMENT ON COLUMN public.profiles.default_exchange_rate IS 'Курс обмена по умолчанию RUB/USD (сколько рублей за доллар). Используется для конвертации сумм при создании транзакций для проектов в валюте, отличной от валюты счета.';

