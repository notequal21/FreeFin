# Контекст и Стек
Ты — эксперт-разработчик. Проект: "freefin" (учет финансов для фрилансеров).
- Фреймворк: Next.js 16 (App Router) + React 19.
- Бэкенд: Supabase с использованием @supabase/ssr для аутентификации и запросов на стороне сервера/клиента.
- Стили: Tailwind CSS 4 + shadcn/ui (пресет Maia/Emerald).
- Валидация: Zod + react-hook-form.
- Запросы: TanStack Query v5.
- Иконки: Hugeicons React (приоритетно) и Lucide React.

# Правила работы с Базой Данных (database.md)
- Сверяйся со схемой в database.md.
- ПОЛЕ `converted_amount` вычисляется триггером в БД. НИКОГДА не передавай его в INSERT/UPDATE.
- Для работы с данными используй только клиент Supabase. Игнорируй библиотеку axios для запросов к БД.
- Используй Row Level Security (RLS) логику: доступ разрешен только если `profiles.is_approved === true`.

# UI и Компоненты (shadcn + Tailwind 4)
- Соблюдай стиль пресета: радиус `large`, цветовая схема `zinc/emerald`.
- Используй `cn()` из `lib/utils` для объединения классов Tailwind.
- Для анимаций используй `tw-animate-css` (в соответствии с package.json).
- Формы строй на базе `react-hook-form` + `zod` + компоненты `Form` из shadcn.
- Уведомления выводи через `sonner` (toast).

# Архитектура Next.js 16 & Supabase SSR
- Используй `createClient` из `@supabase/ssr` для Server Components и Client Components.
- При создании Server Components проверяй сессию пользователя через `supabase.auth.getUser()`.
- Реализуй Middleware для защиты роутов, проверяя флаг `is_approved`.

# Особенности кода
- Используй TypeScript 5: строгая типизация обязательна.
- Для иконок используй `@hugeicons/react` согласно настройке пресета.
- Все серверные действия (Server Actions) должны валидировать входящие данные через Zod.
- Если пользователь не одобрен (`is_approved: false`), показывай компонент-заглушку "Ожидание подтверждения".

# Синхронизация схемы и документации
- Если ты вносишь изменения в логику данных или предлагаешь новые таблицы/колонки:
  1. СНАЧАЛА обнови `supabase-schema.sql` (DDL код).
  2. ЗАТЕМ обнови `database.md` (описание сущностей).
  3. Только после этого пиши код приложения.
- При обновлении `supabase-schema.sql` всегда сохраняй структуру: таблицы -> триггеры -> RLS политики.
- Всегда комментируй в SQL файле, какие изменения были внесены.